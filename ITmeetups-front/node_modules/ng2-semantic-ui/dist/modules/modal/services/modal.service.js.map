{"version":3,"file":"modal.service.js","sourceRoot":"","sources":["../../../../src/modules/modal/services/modal.service.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAC3C,OAAO,EAAE,mBAAmB,EAAE,MAAM,0BAA0B,CAAC;AAC/D,OAAO,EAAe,mBAAmB,EAAE,oBAAoB,EAAE,MAAM,yBAAyB,CAAC;AACjG,OAAO,EAAE,QAAQ,EAAE,MAAM,qBAAqB,CAAC;AAC/C,OAAO,EAAE,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAClD,OAAO,EAAE,WAAW,EAAE,MAAM,yBAAyB,CAAC;;IAIlD,yBAAoB,iBAAqC;QAArC,sBAAiB,GAAjB,iBAAiB,CAAoB;KAAI;IAEtD,8BAAI,GAAX,UAAqB,KAA0B;;QAE3C,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAiB,QAAQ,CAAC,CAAC;;QAGtF,IAAM,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC;QAE7C,EAAE,CAAC,CAAC,KAAK,YAAY,mBAAmB,CAAC,CAAC,CAAC;;YAEvC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,cAAc,CAAC,eAAe,EAAE,KAAK,CAAC,QAAQ,EAAE;;gBAE9E,SAAS,EAAE,KAAK,CAAC,OAAO;;gBAExB,KAAK,EAAE,YAAY,CAAC,QAAQ,CAAC,QAAQ;aACxC,CAAC,CAAC;SACN;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,YAAY,oBAAoB,CAAC,CAAC,CAAC;;;YAG/C,IAAM,mBAAmB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAC9D,KAAK,CAAC,SAAS,EACf;gBACI;oBACI,OAAO,EAAE,KAAK;oBACd,QAAQ,EAAE,IAAI,KAAK,CAAC,cAAc,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC;iBAC9D;aACJ,CACJ,CAAC;;YAGF,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,mBAAmB,EAAE,cAAc,CAAC,eAAe,CAAC,CAAC;;YAGzF,IAAM,cAAc,GAAG,mBAAmB,CAAC,QAAQ,CAAC,aAAwB,CAAC;;;;YAK7E,OAAO,cAAc,CAAC,aAAa,EAAE,IAAI,cAAc,CAAC,aAAa,IAAI,cAAc,CAAC,UAAU,EAAE,CAAC;gBACjG,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,cAAc,CAAC,WAAW,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC;aACnG;;YAED,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,CAAC;SAClE;;;QAID,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;;QAGzD,cAAc,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;;QAGjC,MAAM,CAAC,IAAI,WAAW,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;KAC/C;;gBAzDJ,UAAU;;;;gBANF,mBAAmB;;0BAD5B;;SAQa,eAAe","sourcesContent":["import { Injectable } from \"@angular/core\";\r\nimport { SuiComponentFactory } from \"../../../misc/util/index\";\r\nimport { ModalConfig, TemplateModalConfig, ComponentModalConfig } from \"../classes/modal-config\";\r\nimport { SuiModal } from \"../components/modal\";\r\nimport { Modal } from \"../classes/modal-controls\";\r\nimport { ActiveModal } from \"../classes/active-modal\";\r\n\r\n@Injectable()\r\nexport class SuiModalService {\r\n    constructor(private _componentFactory:SuiComponentFactory) {}\r\n\r\n    public open<T, U, V>(modal:ModalConfig<T, U, V>):ActiveModal<T, U, V> {\r\n        // Generate the modal component to be shown.\r\n        const componentRef = this._componentFactory.createComponent<SuiModal<U, V>>(SuiModal);\r\n\r\n        // Shorthand for the created modal component instance.\r\n        const modalComponent = componentRef.instance;\r\n\r\n        if (modal instanceof TemplateModalConfig) {\r\n            // Inject the template into the view.\r\n            this._componentFactory.createView(modalComponent.templateSibling, modal.template, {\r\n                // `let-context`\r\n                $implicit: modal.context,\r\n                // `let-modal=\"modal\"`\r\n                modal: componentRef.instance.controls\r\n            });\r\n        } else if (modal instanceof ComponentModalConfig) {\r\n            // Generate the component to be used as the modal content,\r\n            // injecting an instance of `Modal` to be used in the component constructor.\r\n            const contentComponentRef = this._componentFactory.createComponent(\r\n                modal.component,\r\n                [\r\n                    {\r\n                        provide: Modal,\r\n                        useValue: new Modal(modalComponent.controls, modal.context)\r\n                    }\r\n                ]\r\n            );\r\n\r\n            // Insert the new component into the content of the modal.\r\n            this._componentFactory.attachToView(contentComponentRef, modalComponent.templateSibling);\r\n\r\n            // Shorthand for access to the content component's DOM element.\r\n            const contentElement = contentComponentRef.location.nativeElement as Element;\r\n\r\n            // Move all of the DOM elements inside the component to the main modal element.\r\n            // This is done so that CSS classes apply correctly. It does stop any custom styles from working however,\r\n            // so other ways may have to be investigated.\r\n            while (contentElement.hasChildNodes() && contentElement.parentElement && contentElement.firstChild) {\r\n                contentElement.parentElement.appendChild(contentElement.removeChild(contentElement.firstChild));\r\n            }\r\n            // Remove the generated component's 'empty shell' from the DOM.\r\n            this._componentFactory.detachFromDocument(contentComponentRef);\r\n        }\r\n\r\n        // Attach the new modal component to the application.\r\n        // The component will move itself to the document body for correctl styling.\r\n        this._componentFactory.attachToApplication(componentRef);\r\n\r\n        // Initialise the generated modal with the provided config.\r\n        modalComponent.loadConfig(modal);\r\n\r\n        // Return an instance of an `ActiveModal`, so the user can control the new modal.\r\n        return new ActiveModal(modal, componentRef);\r\n    }\r\n}\r\n"]}