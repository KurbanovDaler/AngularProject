{"version":3,"file":"radio-manager.js","sourceRoot":"","sources":["../../../../src/modules/checkbox/directives/radio-manager.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAoB,eAAe,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AACpG,OAAO,EAAE,QAAQ,EAAE,MAAM,qBAAqB,CAAC;AAE/C,OAAO,EAAE,IAAI,EAAE,MAAM,0BAA0B,CAAC;;IAiB5C,yBAAmB,OAAkB;QAAlB,YAAO,GAAP,OAAO,CAAW;QACjC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;KACxB;IAEM,4CAAkB,GAAzB;QAAA,iBAMC;QALG,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,aAAa,EAAE,EAApB,CAAoB,CAAC,CAAC;QAEhE,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,YAAY,EAAE,EAAnB,CAAmB,CAAC,CAAC;KACrE;IAEO,uCAAa,GAArB;QAAA,iBAIC;QAHG,IAAI,CAAC,YAAY;aACZ,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,KAAI,EAAV,CAAU,CAAC;aACvB,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,QAAQ,GAAG,IAAI,EAAjB,CAAiB,CAAC,CAAC;KACxC;IAEO,sCAAY,GAApB;QAAA,iBAgBC;QAfG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,WAAW,EAAE,EAAf,CAAe,CAAC,CAAC;QAC9C,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QAErB,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,CAAC;QAC1E,MAAM;aACD,IAAI,CAAC,MAAM,CAAC;aACZ,GAAG,CAAC,UAAA,CAAC,IAAI,OAAA,MAAM,CAAC,CAAC,CAAC,EAAT,CAAS,CAAC;aACnB,OAAO,CAAC,UAAA,CAAC;YAAI,OAAA,CAAC;iBACV,OAAO,CAAC,UAAA,CAAC;gBAAI,OAAA,KAAI,CAAC,UAAU;qBACxB,IAAI,CAAC,CAAC,CAAC,oBAAoB;qBACvB,SAAS,CAAC,UAAC,CAAG;oBACX,EAAE,CAAC,CAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;wBACjB,CAAC,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,EAAnB,CAAmB,CAAC,CAAC;qBAC3C;iBACJ,CAAC,CAAC;YANG,CAMH,CAAC;QAPF,CAOE,CAAC,CAAC;KACzB;;gBAlDJ,SAAS,SAAC;oBACP,QAAQ,EAAE,oDAAoD;iBACjE;;;;gBAPiE,UAAU;;;iCAYvE,eAAe,SAAC,eAAe,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE;oCAGtD,eAAe,SAAC,QAAQ,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE;;0BAfpD;;SAQa,eAAe","sourcesContent":["import { Directive, AfterContentInit, ContentChildren, QueryList, ElementRef } from \"@angular/core\";\r\nimport { SuiRadio } from \"../components/radio\";\r\nimport { Subscription } from \"rxjs/Subscription\";\r\nimport { Util } from \"../../../misc/util/index\";\r\n\r\n@Directive({\r\n    selector: \"form:not([ngForm]):not([[ngForm]]),ngForm,[ngForm]\"\r\n})\r\nexport class SuiRadioManager<T> implements AfterContentInit {\r\n\r\n    public isNested:boolean;\r\n\r\n    @ContentChildren(SuiRadioManager, { descendants: true })\r\n    private _subManagers:QueryList<SuiRadioManager<T>>;\r\n\r\n    @ContentChildren(SuiRadio, { descendants: true })\r\n    private _renderedRadios:QueryList<SuiRadio<T>>;\r\n\r\n    private _radioSubs:Subscription[];\r\n\r\n    constructor(public element:ElementRef) {\r\n        this.isNested = false;\r\n        this._radioSubs = [];\r\n    }\r\n\r\n    public ngAfterContentInit():void {\r\n        this.updateNesting();\r\n        this._subManagers.changes.subscribe(() => this.updateNesting());\r\n\r\n        this.updateRadios();\r\n        this._renderedRadios.changes.subscribe(() => this.updateRadios());\r\n    }\r\n\r\n    private updateNesting():void {\r\n        this._subManagers\r\n            .filter(m => m !== this)\r\n            .forEach(m => m.isNested = true);\r\n    }\r\n\r\n    private updateRadios():void {\r\n        this._radioSubs.forEach(s => s.unsubscribe());\r\n        this._radioSubs = [];\r\n\r\n        const groups = Util.Array.groupBy(this._renderedRadios.toArray(), \"name\");\r\n        Object\r\n            .keys(groups)\r\n            .map(k => groups[k])\r\n            .forEach(g => g\r\n                .forEach(r => this._radioSubs\r\n                    .push(r.onCurrentValueChange\r\n                        .subscribe((v:T) => {\r\n                            if (!this.isNested) {\r\n                                g.forEach(radio => radio.writeValue(v));\r\n                            }\r\n                        }))));\r\n    }\r\n}\r\n"]}