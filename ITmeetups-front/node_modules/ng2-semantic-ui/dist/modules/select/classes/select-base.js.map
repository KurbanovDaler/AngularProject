{"version":3,"file":"select-base.js","sourceRoot":"","sources":["../../../../src/modules/select/classes/select-base.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n    ViewChild, HostBinding, ElementRef, HostListener, Input, ContentChildren, QueryList,\r\n    AfterContentInit, TemplateRef, ViewContainerRef, ContentChild, EventEmitter, Output, OnDestroy, Renderer2\r\n} from \"@angular/core\";\r\nimport { Subscription } from \"rxjs/Subscription\";\r\nimport { DropdownService, SuiDropdownMenu } from \"../../dropdown/index\";\r\nimport { SearchService, LookupFn, FilterFn } from \"../../search/index\";\r\nimport { Util, ITemplateRefContext, HandledEvent, KeyCode, IFocusEvent } from \"../../../misc/util/index\";\r\nimport { ISelectLocaleValues, RecursivePartial, SuiLocalizationService } from \"../../../behaviors/localization/index\";\r\nimport { SuiSelectOption } from \"../components/select-option\";\r\nimport { SuiSelectSearch } from \"../directives/select-search\";\r\n\r\nexport interface IOptionContext<T> extends ITemplateRefContext<T> {\r\n    query?:string;\r\n}\r\n\r\n// We use generic type T to specify the type of the options we are working with,\r\n// and U to specify the type of the property of the option used as the value.\r\nexport abstract class SuiSelectBase<T, U> implements AfterContentInit, OnDestroy {\r\n    public dropdownService:DropdownService;\r\n    public searchService:SearchService<T, U>;\r\n\r\n    @ViewChild(SuiDropdownMenu)\r\n    protected _menu:SuiDropdownMenu;\r\n\r\n    // Keep track of all of the rendered select options. (Rendered by the user using *ngFor).\r\n    @ContentChildren(SuiSelectOption, { descendants: true })\r\n    protected _renderedOptions:QueryList<SuiSelectOption<T>>;\r\n\r\n    // Keep track of all of the subscriptions to the selected events on the rendered options.\r\n    private _renderedSubscriptions:Subscription[];\r\n\r\n    // Sets the Semantic UI classes on the host element.\r\n    @HostBinding(\"class.ui\")\r\n    @HostBinding(\"class.dropdown\")\r\n    private _selectClasses:boolean;\r\n\r\n    @HostBinding(\"class.active\")\r\n    public get isActive():boolean {\r\n        return this.dropdownService.isOpen;\r\n    }\r\n\r\n    @HostBinding(\"class.visible\")\r\n    public get isVisible():boolean {\r\n        return this._menu.isVisible;\r\n    }\r\n\r\n    @Input()\r\n    public isSearchable:boolean;\r\n\r\n    public isSearchExternal:boolean;\r\n\r\n    @HostBinding(\"class.search\")\r\n    private get _searchClass():boolean {\r\n        return this.isSearchable && !this.isSearchExternal;\r\n    }\r\n\r\n    @HostBinding(\"class.loading\")\r\n    public get isSearching():boolean {\r\n        return this.searchService.isSearching;\r\n    }\r\n\r\n    @ViewChild(SuiSelectSearch)\r\n    private _internalSearch?:SuiSelectSearch;\r\n\r\n    @ContentChild(SuiSelectSearch)\r\n    private _manualSearch?:SuiSelectSearch;\r\n\r\n    public get searchInput():SuiSelectSearch | undefined {\r\n        return this._manualSearch || this._internalSearch;\r\n    }\r\n\r\n    @Input(\"tabindex\")\r\n    private _tabIndex?:number;\r\n\r\n    @HostBinding(\"attr.tabindex\")\r\n    public get tabIndex():number {\r\n        if (this.isDisabled) {\r\n            // If disabled, remove from tabindex.\r\n            return -1;\r\n        }\r\n        if (this.dropdownService.isOpen && this.isSearchExternal) {\r\n            // If open & in menu search, remove from tabindex (as input always autofocusses).\r\n            return -1;\r\n        }\r\n        if (this._tabIndex != undefined) {\r\n            // If custom tabindex, default to that.\r\n            return this._tabIndex;\r\n        }\r\n        if (this._searchClass) {\r\n            // If search input enabled, tab goes to input.\r\n            return -1;\r\n        }\r\n        // Otherwise, return default of 0.\r\n        return 0;\r\n    }\r\n\r\n    @HostBinding(\"class.disabled\")\r\n    @Input()\r\n    public get isDisabled():boolean {\r\n        return this.dropdownService.isDisabled;\r\n    }\r\n\r\n    public set isDisabled(value:boolean) {\r\n        this.dropdownService.isDisabled = !!value;\r\n    }\r\n\r\n    @Input()\r\n    public set options(options:T[]) {\r\n        if (options) {\r\n            this.searchService.options = options;\r\n\r\n            this.optionsUpdateHook();\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    public set optionsFilter(filter:FilterFn<T> | undefined) {\r\n        if (filter) {\r\n            this.searchService.optionsFilter = filter;\r\n\r\n            this.optionsUpdateHook();\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    public set optionsLookup(lookup:LookupFn<T, U> | undefined) {\r\n        if (lookup) {\r\n            this.searchService.optionsLookup = lookup;\r\n\r\n            this.optionsUpdateHook();\r\n        }\r\n    }\r\n\r\n    public get filteredOptions():T[] {\r\n        return this.searchService.results;\r\n    }\r\n\r\n    // Deprecated\r\n    public get availableOptions():T[] {\r\n        return this.filteredOptions;\r\n    }\r\n\r\n    public get query():string | undefined {\r\n        return this.isSearchable ? this.searchService.query : undefined;\r\n    }\r\n\r\n    public set query(query:string | undefined) {\r\n        if (query != undefined) {\r\n            this.queryUpdateHook();\r\n            this.updateQuery(query);\r\n            // Update the rendered text as query has changed.\r\n            this._renderedOptions.forEach(ro => this.initialiseRenderedOption(ro));\r\n\r\n            if (this.searchInput) {\r\n                this.searchInput.query = query;\r\n            }\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    public get labelField():string | undefined {\r\n        return this.searchService.optionsField;\r\n    }\r\n\r\n    public set labelField(field:string | undefined) {\r\n        this.searchService.optionsField = field;\r\n    }\r\n\r\n    public get labelGetter():(obj:T) => string {\r\n        // Helper function to retrieve the label from an item.\r\n        return (obj:T) => {\r\n            const label = Util.Object.readValue<T, string>(obj, this.labelField);\r\n            if (label != undefined) {\r\n                return label.toString();\r\n            }\r\n            return \"\";\r\n        };\r\n    }\r\n\r\n    @Input()\r\n    public valueField:string;\r\n\r\n    public get valueGetter():(obj:T) => U {\r\n        // Helper function to retrieve the value from an item.\r\n        return (obj:T) => Util.Object.readValue<T, U>(obj, this.valueField);\r\n    }\r\n\r\n    @Input()\r\n    public optionTemplate:TemplateRef<IOptionContext<T>>;\r\n\r\n    private _optionFormatter?:(o:T, q?:string) => string;\r\n\r\n    public get configuredFormatter():(option:T) => string {\r\n        if (this._optionFormatter) {\r\n            return o => this._optionFormatter!(o, this.isSearchable ? this.query : undefined);\r\n        } else if (this.searchService.optionsLookup) {\r\n            return o => this.labelGetter(o);\r\n        } else {\r\n            return o => this.searchService.highlightMatches(this.labelGetter(o), this.query || \"\");\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    public set optionFormatter(formatter:((option:T, query?:string) => string) | undefined) {\r\n        this._optionFormatter = formatter;\r\n    }\r\n\r\n    private _localeValues:ISelectLocaleValues;\r\n    public localeOverrides:RecursivePartial<ISelectLocaleValues>;\r\n\r\n    public get localeValues():ISelectLocaleValues {\r\n        return this._localizationService.override<\"select\">(this._localeValues, this.localeOverrides);\r\n    }\r\n\r\n    @Input()\r\n    public icon:string;\r\n\r\n    @Input()\r\n    public transition:string;\r\n\r\n    @Input()\r\n    public transitionDuration:number;\r\n\r\n    @Output(\"touched\")\r\n    public onTouched:EventEmitter<void>;\r\n\r\n    private _documentKeyDownListener:() => void;\r\n\r\n    constructor(private _element:ElementRef, renderer:Renderer2, protected _localizationService:SuiLocalizationService) {\r\n        this.dropdownService = new DropdownService();\r\n        // We do want an empty query to return all results.\r\n        this.searchService = new SearchService<T, U>(true);\r\n\r\n        this.isSearchable = false;\r\n\r\n        this.onLocaleUpdate();\r\n        this._localizationService.onLanguageUpdate.subscribe(() => this.onLocaleUpdate());\r\n        this._renderedSubscriptions = [];\r\n\r\n        this.icon = \"dropdown\";\r\n        this.transition = \"slide down\";\r\n        this.transitionDuration = 200;\r\n\r\n        this.onTouched = new EventEmitter<void>();\r\n        this._documentKeyDownListener = renderer.listen(\"document\", \"keydown\", (e:KeyboardEvent) => this.onDocumentKeyDown(e));\r\n\r\n        this._selectClasses = true;\r\n    }\r\n\r\n    public ngAfterContentInit():void {\r\n        this._menu.service = this.dropdownService;\r\n        // We manually specify the menu items to the menu because the @ContentChildren doesn't pick up our dynamically rendered items.\r\n        this._menu.items = this._renderedOptions;\r\n\r\n        if (this._manualSearch) {\r\n            this.isSearchable = true;\r\n            this.isSearchExternal = true;\r\n        }\r\n\r\n        if (this.searchInput) {\r\n            this.searchInput.onQueryUpdated.subscribe((q:string) => this.query = q);\r\n            this.searchInput.onQueryKeyDown.subscribe((e:KeyboardEvent) => this.onQueryInputKeydown(e));\r\n        }\r\n\r\n        // We must call this immediately as changes doesn't fire when you subscribe.\r\n        this.onAvailableOptionsRendered();\r\n        this._renderedOptions.changes.subscribe(() => this.onAvailableOptionsRendered());\r\n    }\r\n\r\n    private onLocaleUpdate():void {\r\n        this._localeValues = this._localizationService.get().select;\r\n    }\r\n\r\n    // Hook is here since Typescript doesn't yet support overriding getters & setters while still calling the superclass.\r\n    protected optionsUpdateHook():void {}\r\n\r\n    // Hook is here since Typescript doesn't yet support overriding getters & setters while still calling the superclass.\r\n    protected queryUpdateHook():void {}\r\n\r\n    protected updateQuery(query:string):void {\r\n        // Update the query then open the dropdown, as after keyboard input it should always be open.\r\n        this.searchService.updateQuery(query, () =>\r\n            this.dropdownService.setOpenState(true));\r\n    }\r\n\r\n    protected resetQuery(delayed:boolean = true):void {\r\n        // The search delay is set to the transition duration to ensure results\r\n        // aren't rendered as the select closes as that causes a sudden flash.\r\n        if (delayed) {\r\n            this.searchService.searchDelay = this._menu.menuTransitionDuration;\r\n            this.searchService.updateQueryDelayed(\"\");\r\n        } else {\r\n            this.searchService.updateQuery(\"\");\r\n        }\r\n\r\n        if (this.searchInput) {\r\n            this.searchInput.query = \"\";\r\n        }\r\n    }\r\n\r\n    protected onAvailableOptionsRendered():void {\r\n        // Unsubscribe from all previous subscriptions to avoid memory leaks on large selects.\r\n        this._renderedSubscriptions.forEach(rs => rs.unsubscribe());\r\n        this._renderedSubscriptions = [];\r\n\r\n        this._renderedOptions.forEach(ro => {\r\n            // Slightly delay initialisation to avoid change after checked errors. TODO - look into avoiding this!\r\n            setTimeout(() => this.initialiseRenderedOption(ro));\r\n\r\n            this._renderedSubscriptions.push(ro.onSelected.subscribe(() => this.selectOption(ro.value)));\r\n        });\r\n\r\n        // If no options have been provided, autogenerate them from the rendered ones.\r\n        if (this.searchService.options.length === 0 && !this.searchService.optionsLookup) {\r\n            this.options = this._renderedOptions.map(ro => ro.value);\r\n        }\r\n    }\r\n\r\n    protected initialiseRenderedOption(option:SuiSelectOption<T>):void {\r\n        option.usesTemplate = !!this.optionTemplate;\r\n        option.formatter = this.configuredFormatter;\r\n\r\n        if (option.usesTemplate) {\r\n            this.drawTemplate(option.templateSibling, option.value);\r\n        }\r\n\r\n        option.changeDetector.markForCheck();\r\n    }\r\n\r\n    public abstract selectOption(option:T):void;\r\n\r\n    protected findOption(options:T[], value:U):T | undefined {\r\n        // Tries to find an option in options array\r\n        return options.find(o => value === this.valueGetter(o));\r\n    }\r\n\r\n    public onCaretClick(e:HandledEvent):void {\r\n        if (!e.eventHandled) {\r\n            e.eventHandled = true;\r\n\r\n            if (!this.dropdownService.isAnimating) {\r\n                this.dropdownService.setOpenState(!this.dropdownService.isOpen);\r\n\r\n                this.focus();\r\n            }\r\n        }\r\n    }\r\n\r\n    @HostListener(\"click\", [\"$event\"])\r\n    public onClick(e:HandledEvent):void {\r\n        if (!e.eventHandled && !this.dropdownService.isAnimating) {\r\n            e.eventHandled = true;\r\n\r\n            // If the dropdown is searchable, clicking should keep it open, otherwise we toggle the open state.\r\n            this.dropdownService.setOpenState(this.isSearchable ? true : !this.dropdownService.isOpen);\r\n\r\n            // Immediately focus the search input whenever clicking on the select.\r\n            this.focus();\r\n        }\r\n    }\r\n\r\n    @HostListener(\"focusin\")\r\n    private onFocusIn():void {\r\n        if (!this.dropdownService.isOpen && !this.dropdownService.isAnimating) {\r\n            this.dropdownService.setOpenState(true);\r\n\r\n            this.focus();\r\n        }\r\n    }\r\n\r\n    @HostListener(\"focusout\", [\"$event\"])\r\n    private onFocusOut(e:IFocusEvent):void {\r\n        if (!this._element.nativeElement.contains(e.relatedTarget)) {\r\n            this.dropdownService.setOpenState(false);\r\n            this.onTouched.emit();\r\n        }\r\n    }\r\n\r\n    @HostListener(\"keypress\", [\"$event\"])\r\n    public onKeyPress(e:KeyboardEvent):void {\r\n        if (e.keyCode === KeyCode.Enter) {\r\n            // Enables support for focussing and opening with the keyboard alone.\r\n            // Using directly because Renderer2 doesn't have invokeElementMethod method anymore.\r\n            this._element.nativeElement.click();\r\n        }\r\n    }\r\n\r\n    public onDocumentKeyDown(e:KeyboardEvent):void {\r\n        if (this._element.nativeElement.contains(e.target) &&\r\n            !this.dropdownService.isOpen &&\r\n            e.keyCode === KeyCode.Down) {\r\n\r\n            // Enables support for focussing and opening with the keyboard alone.\r\n            // Using directly because Renderer2 doesn't have invokeElementMethod method anymore.\r\n            this._element.nativeElement.click();\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    public onQueryInputKeydown(event:KeyboardEvent):void {}\r\n\r\n    protected focus():void {\r\n        if (this.isSearchable && this.searchInput) {\r\n            // Focusses the search input only when searchable.\r\n            // Using directly because Renderer2 doesn't have invokeElementMethod method anymore.\r\n            this.searchInput.focus();\r\n        } else {\r\n            this._element.nativeElement.focus();\r\n        }\r\n    }\r\n\r\n    // Helper that draws the provided template beside the provided ViewContainerRef.\r\n    protected drawTemplate(siblingRef:ViewContainerRef, value:T):void {\r\n        siblingRef.clear();\r\n        // Use of `$implicit` means use of <ng-template let-option> syntax is supported.\r\n        siblingRef.createEmbeddedView(this.optionTemplate, {\r\n            $implicit: value,\r\n            query: this.query\r\n        });\r\n    }\r\n\r\n    public ngOnDestroy():void {\r\n        this._renderedSubscriptions.forEach(s => s.unsubscribe());\r\n        this._documentKeyDownListener();\r\n    }\r\n}\r\n"]}